<!DOCTYPE html>
<html lang="fr">

<link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#0b4aa2">

<link rel="icon" href="./icons/icon-192.png">
<link rel="apple-touch-icon" href="./icons/apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Colivex">#
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculatrice Colivex</title>

<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
.container{max-width:520px;margin:auto;padding:15px;background:#fff;border-radius:12px}
h2{text-align:center;color:#0b3c5d}
label{font-weight:bold;margin-top:10px;display:block}
input,select,button{width:100%;padding:10px;margin-top:5px;border-radius:8px;border:1px solid #ccc;font-size:16px}
button{background:#c4161c;color:#fff;border:none;margin-top:12px}
.box{margin-top:15px;padding:15px;border-left:5px solid #0b3c5d;background:#f9fbfc;border-radius:8px}
.line{display:flex;justify-content:space-between;margin:6px 0}
.total{font-weight:bold;font-size:18px}
.extra-row{display:flex;gap:6px;margin-top:6px}
.small{font-size:13px;color:#555}
</style>
</head>

<body>
<div class="container">
<h2>Calculatrice terrain – Colivex</h2>

<label>Taux horaire ($)</label>
<input type="number" id="rate" value="155">

<label>Heure d’arrivée</label>
<input type="time" id="start">

<label>Heure de départ</label>
<input type="time" id="end">

<label>Transport (heures)</label>
<select id="transport">
<option value="0">0 h</option>
<option value="0.5">0.5 h</option>
<option value="1" selected>1 h</option>
<option value="1.5">1.5 h</option>
</select>

<label>Extras (panier)</label>
<div class="extra-row">
<select id="extraSelect">
<option value="">Choisir un article</option>
<option data-price="2.5">Ruban adhésif (TAPE) – 2.50 $</option>
<option data-price="6">Housse matelas 39" – 6.00 $</option>
<option data-price="8">Housse matelas 60" – 8.00 $</option>
<option data-price="11">Housse matelas 70" – 11.00 $</option>
<option data-price="2.25">Boîte 1.5 pi³ – 2.25 $</option>
<option data-price="2.75">Boîte 2 pi³ – 2.75 $</option>
<option data-price="4.5">Boîte 4 pi³ – 4.50 $</option>
<option data-price="5.5">Boîte 5 pi³ – 5.50 $</option>
<option data-price="7">Boîte vaisselle – 7.00 $</option>
<option data-price="7.5">Boîte abat-jour – 7.50 $</option>
<option data-price="18.5">Boîte garde-robe – 18.50 $</option>
<option data-price="0">Garde-robe NO CHARGE – 0.00 $</option>
<option data-price="7.5">Boîte miroir/cadre (Inner) – 7.50 $</option>
<option data-price="8.5">Boîte miroir/cadre (Outer) – 8.50 $</option>
<option data-price="8.5">Papier bulles 5' – 8.50 $</option>
<option data-price="8.5">Papier bulles 10' – 8.50 $</option>
<option data-price="15">Papier emballage 10 lb – 15.00 $</option>
<option data-price="27.5">Papier emballage 25 lb – 27.50 $</option>
<option data-price="25">Couverture matelassée – 25.00 $</option>
<option data-price="15">Couverture matelassée usagée – 15.00 $</option>
<option data-price="18.5">Garde-robe usagée – 18.50 $</option>
</select>
<input type="number" id="extraQty" min="1" value="1">
</div>

<button onclick="addExtra()">Ajouter l’extra</button>
<div class="small" id="extrasList"></div>

<label>Taxes</label>
<select id="taxMode">
<option value="with">Avec taxes</option>
<option value="without">Sans taxes</option>
</select>

<label>Dépôt (taxes incluses)</label>
<select id="deposit">
<option value="0">Aucun</option>
<option value="250" selected>250 $</option>
</select>

<button onclick="calculate()">Calculer</button>

<div class="box">
<div class="line"><span>Heures travaillées</span><strong id="workH">0.00 h</strong></div>
<div class="line"><span>Heures facturables</span><strong id="billH">0.00 h</strong></div>
<hr>
<div class="line"><span>Sous-total</span><strong id="sub">0.00 $</strong></div>
<div class="line"><span>Extras</span><strong id="extraTotal">0.00 $</strong></div>
<div class="line"><span>TPS (5%)</span><strong id="tps">0.00 $</strong></div>
<div class="line"><span>TVQ (9.975%)</span><strong id="tvq">0.00 $</strong></div>
<div class="line total"><span>Total taxes incluses</span><span id="total">0.00 $</span></div>
<div class="line"><span>Dépôt reçu</span><strong id="dep">-0.00 $</strong></div>
<div class="line total"><span>Grand total à payer</span><span id="grand">0.00 $</span></div>
</div>
</div>

<script>
let extras=[];

function round15(m){return Math.ceil(m/15)*15}

function addExtra(){
const sel=document.getElementById("extraSelect");
if(!sel.value)return;
extras.push({
name:sel.options[sel.selectedIndex].text,
price:parseFloat(sel.options[sel.selectedIndex].dataset.price),
qty:parseInt(extraQty.value)
});
renderExtras();
}

function renderExtras(){
extrasList.innerHTML="";
extras.forEach(e=>{
extrasList.innerHTML+=`${e.qty} × ${e.name}<br>`;
});
}

function calculate(){
const rate=+rateInput.value||+rate.value;
const s=new Date(`1970-01-01T${start.value}`);
const e=new Date(`1970-01-01T${end.value}`);
if(!start.value||!end.value)return;

let mins=round15((e-s)/60000);
let workH=mins/60;
let billH=Math.max(workH,3)+parseFloat(transport.value);

let extraSum=extras.reduce((t,e)=>t+e.price*e.qty,0);
let sub=(rate*billH)+extraSum;

let tps=0,tvq=0;
if(taxMode.value==="with"){tps=sub*0.05;tvq=sub*0.09975}

let total=sub+tps+tvq;
let dep=+deposit.value;
let grand=total-dep;

workH.textContent=workH.toFixed(2)+" h";
billH.textContent=billH.toFixed(2)+" h";
sub.textContent=sub.toFixed(2)+" $";
extraTotal.textContent=extraSum.toFixed(2)+" $";
tps.textContent=tps.toFixed(2)+" $";
tvq.textContent=tvq.toFixed(2)+" $";
total.textContent=total.toFixed(2)+" $";
dep.textContent="-"+dep.toFixed(2)+" $";
grand.textContent=grand.toFixed(2)+" $";
}
</script>
</body>
</html