<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Calculatrice Transport Colivex</title>

<style>
:root{
  --blue:#1f4e79;   /* Bleu ancienne calculatrice */
  --red:#c00000;    /* Rouge bouton Calculer */
  --bg:#f5f6f7;
  --card:#ffffff;
  --border:#d0d7de;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:var(--bg);
}

.container{
  max-width:760px;
  margin:auto;
  padding:14px;
}

/* HEADER ANCIEN STYLE */
.header{
  background:var(--blue);
  color:#fff;
  border-radius:10px;
  padding:16px;
  text-align:center;
}

.header img{
  max-width:200px;
  margin-bottom:10px;
  background:#fff;
  padding:8px;
  border-radius:6px;
}

/* CARTES */
.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:8px;
  padding:14px;
  margin-top:14px;
}

label{
  font-weight:700;
  font-size:14px;
}

input,select,button{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:6px;
  border:1px solid var(--border);
  font-size:16px;
}

/* BOUTONS */
button.primary{
  background:var(--red);
  color:#fff;
  font-weight:900;
  border:none;
  cursor:pointer;
}

button.secondary{
  background:#fff;
  font-weight:700;
  cursor:pointer;
}

/* GRILLE */
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:600px){
  .row{grid-template-columns:1fr}
}

/* EXTRAS */
.extraItem{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border:1px solid var(--border);
  padding:8px;
  margin-top:6px;
  border-radius:6px;
}

.remove{
  background:#fff;
  border:1px solid var(--border);
  width:36px;
  height:36px;
  font-size:18px;
  cursor:pointer;
}

/* TOTAL */
.totalBox{
  border:2px solid var(--blue);
  border-radius:8px;
  padding:14px;
}
.small{font-size:13px;color:#555}
</style>
</head>

<body>
<div class="container">

  <div class="header">
    <img src="./logo-colivex.png" alt="Transport Colivex">
    <h2>Calculatrice de facture</h2>
  </div>

  <!-- HEURES AUTO -->
  <div class="card row">
    <div>
      <label>Heure d’arrivée</label>
      <input id="startTime" type="time">
    </div>
    <div>
      <label>Heure de départ</label>
      <input id="endTime" type="time">
    </div>
    <div>
      <label>Heures travaillées (auto)</label>
      <input id="hours" type="number" readonly>
    </div>
    <div>
      <label>Tarif horaire ($)</label>
      <input id="rate" type="number" value="145">
    </div>
    <div>
      <label>Frais transport (heures)</label>
      <input id="transport" type="number" value="1" step="0.25">
    </div>
    <div>
      <label>Dépôt reçu (tx incl.)</label>
      <input id="deposit" type="number" value="250">
    </div>
  </div>

  <!-- EXTRAS -->
  <div class="card">
    <label>Extras</label>
    <select id="extraSelect">
      <option value="2.5">Tape 2" — 2,50 $</option>
      <option value="6">Housse matelas 39" — 6,00 $</option>
      <option value="8">Housse matelas 60" — 8,00 $</option>
      <option value="11">Housse matelas 70" — 11,00 $</option>
      <option value="18.5">Boîte garde-robe — 18,50 $</option>
    </select>

    <input id="qty" type="number" value="1" min="1">
    <button class="primary" onclick="addExtra()">Ajouter extra</button>
    <button class="secondary" onclick="clearExtras()">Vider extras</button>

    <div id="extras"></div>
  </div>

  <!-- CALCUL -->
  <div class="card">
    <button class="primary" onclick="calculate()">Calculer</button>
  </div>

  <div class="card totalBox" id="resultBox" style="display:none">
    <p>Sous-total : <strong id="sub"></strong></p>
    <p>TPS : <strong id="tps"></strong></p>
    <p>TVQ : <strong id="tvq"></strong></p>
    <p>Dépôt : <strong id="dep"></strong></p>
    <h3>Total à payer : <span id="total"></span></h3>
  </div>

</div>

<script>
const extras=[];
function money(v){return v.toLocaleString("fr-CA",{style:"currency",currency:"CAD"});}

function toMin(t){if(!t)return null;const[a,b]=t.split(":");return a*60+ +b;}
function updateHours(){
  const s=toMin(startTime.value), e=toMin(endTime.value);
  if(s==null||e==null)return;
  let d=e-s; if(d<0)d+=1440;
  hours.value=(Math.round(d/60*100)/100);
}
startTime.oninput=endTime.oninput=updateHours;

function addExtra(){
  extras.push({name:extraSelect.options[extraSelect.selectedIndex].text,price:+extraSelect.value,qty:+qty.value});
  renderExtras();
}
function renderExtras(){
  extrasDiv.innerHTML="";
  extras.forEach((e,i)=>{
    extrasDiv.innerHTML+=`<div class="extraItem">${e.qty} × ${e.name}<button class="remove" onclick="removeExtra(${i})">✕</button></div>`;
  });
}
function removeExtra(i){extras.splice(i,1);renderExtras();}
function clearExtras(){extras.length=0;renderExtras();}

function calculate(){
  let subtotal=(rate.value*hours.value)+(rate.value*transport.value);
  extras.forEach(e=>subtotal+=e.price*e.qty);
  const tps=subtotal*0.05, tvq=subtotal*0.09975;
  const total=subtotal+tps+tvq-deposit.value;
  sub.textContent=money(subtotal);
  tpsEl.textContent=money(tps);
  tvqEl.textContent=money(tvq);
  dep.textContent="-"+money(deposit.value);
  totalEl.textContent=money(total);
  resultBox.style.display="block";
}

const extrasDiv=document.getElementById("extras");
const tpsEl=document.getElementById("tps");
const tvqEl=document.getElementById("tvq");
const totalEl=document.getElementById("total");
</script>

</body>
</html