<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Calculatrice Transport Colivex</title>

<style>
:root{
  /* STYLE EXACT PHOTO (bleu foncé + rouge) */
  --blue:#1f4e79;     /* bleu des titres / cadres */
  --blue2:#163a5b;    /* bleu plus foncé pour bordures */
  --red:#c00000;      /* rouge bouton Calculer */
  --bg:#ffffff;
  --border:#d9dde3;
  --soft:#f6f7f9;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:var(--bg);
  color:#111;
}
.container{
  max-width:760px;
  margin:0 auto;
  padding:14px;
}

/* Bandeau bleu (comme dans la photo) */
.topBar{
  background:var(--blue);
  color:#fff;
  border-radius:10px;
  padding:14px 12px;
  text-align:center;
  font-weight:900;
  font-size:18px;
  margin-bottom:12px;
}

/* Cartes */
.card{
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
  padding:14px;
  margin-bottom:12px;
}

/* Titres de section bleu */
.sectionTitle{
  background:var(--blue);
  color:#fff;
  font-weight:900;
  padding:10px 12px;
  border-radius:8px;
  margin:-14px -14px 12px -14px;
}

/* Champs */
label{
  font-weight:800;
  font-size:14px;
  display:block;
  margin-top:10px;
  color:#0f2b45;
}
input, select, button{
  width:100%;
  padding:12px;
  margin-top:6px;
  border:1px solid var(--border);
  border-radius:8px;
  font-size:16px;
  background:#fff;
}

/* Grille */
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:600px){
  .grid{grid-template-columns:1fr;}
}

/* Gros bouton rouge Calculer (comme photo) */
.btnCalc{
  background:var(--red);
  color:#fff;
  border:none;
  font-weight:900;
  font-size:18px;
  padding:14px;
  border-radius:10px;
  cursor:pointer;
}

/* Boutons bleus */
.btnBlue{
  background:var(--blue);
  color:#fff;
  border:none;
  font-weight:900;
  border-radius:10px;
  cursor:pointer;
}

/* Résumé style photo (cadre bleu) */
.summaryBox{
  border:2px solid var(--blue);
  border-radius:12px;
  padding:14px;
  background:#fff;
}
.summaryRow{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:8px 0;
  border-bottom:1px solid var(--border);
}
.summaryRow:last-child{border-bottom:none;}
.summaryRow strong{font-size:16px;}
.totalBig{
  font-size:18px;
  font-weight:900;
}

/* Extras liste */
.extraItem{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px;
  margin-top:8px;
  background:#fff;
  gap:10px;
}
.removeBtn{
  width:40px;
  height:40px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#fff;
  font-size:18px;
  cursor:pointer;
}
.small{
  font-size:13px;
  color:#445;
  margin-top:6px;
}
</style>
</head>

<body>
<div class="container">

  <div class="topBar">Calculatrice Transport Colivex</div>

  <!-- SECTION HEURES AUTO -->
  <div class="card">
    <div class="sectionTitle">Heures</div>

    <div class="grid">
      <div>
        <label>Heure d’arrivée</label>
        <input id="startTime" type="time">
      </div>

      <div>
        <label>Heure de départ</label>
        <input id="endTime" type="time">
      </div>

      <div>
        <label>Heures travaillées (auto)</label>
        <input id="hoursWorked" type="number" step="0.01" readonly>
        <div class="small">Calcul automatique (gère minuit)</div>
      </div>

      <div>
        <label>Tarif horaire ($)</label>
        <input id="rate" type="number" value="145" step="0.01" min="0">
      </div>

      <div>
        <label>Frais transport (heures)</label>
        <input id="transportHours" type="number" value="1" step="0.25" min="0">
        <div class="small">Par défaut : 1h</div>
      </div>

      <div>
        <label>Dépôt reçu (taxes incluses)</label>
        <input id="deposit" type="number" value="250" step="0.01" min="0">
      </div>
    </div>
  </div>

  <!-- SECTION EXTRAS -->
  <div class="card">
    <div class="sectionTitle">Ajouter des extras</div>

    <label>Choisir un extra</label>
    <select id="extraSelect">
      <option value="2.5">Ruban adhésif 2 pouces (TAPE) — 2,50 $</option>
      <option value="6">Housse à matelas 39" (simple) — 6,00 $</option>
      <option value="8">Housse à matelas 60" (queen) — 8,00 $</option>
      <option value="11">Housse à matelas 70" (king) — 11,00 $</option>
      <option value="2.25">Boîte 1,5 pieds cubes — 2,25 $</option>
      <option value="2.75">Boîte 2 pieds cubes — 2,75 $</option>
      <option value="4.5">Boîte 4 pieds cubes — 4,50 $</option>
      <option value="5.5">Boîte 5 pieds cubes — 5,50 $</option>
      <option value="7">Boîte à vaisselle — 7,00 $</option>
      <option value="7.5">Boîte abat-jour — 7,50 $</option>
      <option value="18.5">Boîte garde-robes (inclut la barre) — 18,50 $</option>
      <option value="0">GARDE-ROBES **NO CHARGE** — 0,00 $</option>
      <option value="7.5">Boîte miroir / cadre (Inner) — 7,50 $</option>
      <option value="8.5">Boîte miroir / cadre (Outer) — 8,50 $</option>
      <option value="8.5">Rouleau papier bulles 1/2" x 48" x 5' — 8,50 $</option>
      <option value="8.5">Rouleau papier bulles 3/16" x 48" x 10' — 8,50 $</option>
      <option value="15">Papier d'emballage 10 livres — 15,00 $</option>
      <option value="27.5">Papier d'emballage 25 livres — 27,50 $</option>
      <option value="25">Couverture matelassée — 25,00 $</option>
      <option value="15">Couverture matelassée (usagée) — 15,00 $</option>
      <option value="18.5">Garde-Robes usagée — 18,50 $</option>
    </select>

    <div class="grid">
      <div>
        <label>Quantité</label>
        <input id="extraQty" type="number" value="1" min="1" step="1">
      </div>
      <div style="align-self:end;">
        <button class="btnBlue" type="button" id="addExtraBtn">Ajouter</button>
      </div>
    </div>

    <button class="btnBlue" type="button" id="clearExtrasBtn" style="margin-top:10px;">Vider extras</button>

    <div id="extrasList"></div>
  </div>

  <!-- BOUTON CALCULER -->
  <button class="btnCalc" type="button" id="calcBtn">Calculer</button>

  <!-- RÉSULTATS -->
  <div class="card" id="resultCard" style="display:none; margin-top:12px;">
    <div class="sectionTitle">Résumé</div>

    <div class="summaryBox">
      <div class="summaryRow"><span>Sous-total (avant taxes)</span><strong id="subTotalTxt">0,00 $</strong></div>
      <div class="summaryRow"><span>TPS (5 %)</span><strong id="tpsTxt">0,00 $</strong></div>
      <div class="summaryRow"><span>TVQ (9,975 %)</span><strong id="tvqTxt">0,00 $</strong></div>
      <div class="summaryRow"><span>Total (taxes incluses)</span><strong id="totalTxt" class="totalBig">0,00 $</strong></div>
      <div class="summaryRow"><span>Dépôt reçu (–)</span><strong id="depositTxt">- 0,00 $</strong></div>
      <div class="summaryRow"><span>Total à payer</span><strong id="payableTxt" class="totalBig">0,00 $</strong></div>
    </div>
  </div>

</div>

<script>
const TPS = 0.05;
const TVQ = 0.09975;
const cart = [];

const $ = (id) => document.getElementById(id);
const money = (v) => (Number(v)||0).toLocaleString("fr-CA",{style:"currency",currency:"CAD"});

function timeToMin(t){
  if(!t || !t.includes(":")) return null;
  const [h,m] = t.split(":").map(x => parseInt(x,10));
  if(Number.isNaN(h) || Number.isNaN(m)) return null;
  return h*60 + m;
}

function updateHours(){
  const s = timeToMin($("startTime").value);
  const e = timeToMin($("endTime").value);
  if(s===null || e===null){ $("hoursWorked").value = ""; return; }
  let diff = e - s;
  if(diff < 0) diff += 1440; // passe minuit
  const hours = Math.round((diff/60) * 100) / 100;
  $("hoursWorked").value = hours;
}

function renderExtras(){
  const div = $("extrasList");
  div.innerHTML = "";
  cart.forEach((item, i) => {
    div.innerHTML += `
      <div class="extraItem">
        <div>${item.qty} × ${item.name}</div>
        <button class="removeBtn" type="button" onclick="removeExtra(${i})">✕</button>
      </div>`;
  });
  if(cart.length === 0){
    div.innerHTML = `<div class="small">Aucun extra ajouté.</div>`;
  }
}

function addExtra(){
  const sel = $("extraSelect");
  const name = sel.options[sel.selectedIndex].text;
  const price = parseFloat(sel.value);
  const qty = parseInt($("extraQty").value, 10);

  if(!qty || qty <= 0){ alert("Quantité invalide"); return; }
  cart.push({ name, price, qty });
  renderExtras();
}

function removeExtra(i){
  cart.splice(i, 1);
  renderExtras();
}

function clearExtras(){
  cart.length = 0;
  renderExtras();
}

function calculate(){
  updateHours();

  const rate = parseFloat($("rate").value) || 0;
  const hours = parseFloat($("hoursWorked").value) || 0;
  const transportHours = parseFloat($("transportHours").value) || 0;
  const deposit = parseFloat($("deposit").value) || 0;

  let subTotal = (rate * hours) + (rate * transportHours);
  cart.forEach(it => subTotal += (it.price * it.qty));

  const tps = subTotal * TPS;
  const tvq = subTotal * TVQ;
  const total = subTotal + tps + tvq;
  const payable = total - deposit;

  $("subTotalTxt").textContent = money(subTotal);
  $("tpsTxt").textContent = money(tps);
  $("tvqTxt").textContent = money(tvq);
  $("totalTxt").textContent = money(total);
  $("depositTxt").textContent = "- " + money(deposit);
  $("payableTxt").textContent = money(payable);

  $("resultCard").style.display = "block";
}

$("startTime").addEventListener("input", updateHours);
$("endTime").addEventListener("input", updateHours);
$("addExtraBtn").addEventListener("click", addExtra);
$("clearExtrasBtn").addEventListener("click", clearExtras);
$("calcBtn").addEventListener("click", calculate);

renderExtras();
</script>

</body>
</html>